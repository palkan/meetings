<?xml version="1.0" encoding="utf-8"?>
<settings:SettingsElement xmlns:fx="http://ns.adobe.com/mxml/2009"
                          xmlns:s="library://ns.adobe.com/flex/spark"
                          xmlns:settings="ru.teachbase.module.settings.*"
                          implements="ru.teachbase.utils.interfaces.ILocalable"
                          width="400" height="300"
                          initialize="Localizer.addItem(this);"
                          addedToStage="onAddedToStage()" xmlns:components="ru.teachbase.module.settings.components.*">
    <fx:Declarations>
		<!-- Place non-visual elements (e.g., services, value objects) here -->
		<s:RadioButtonGroup id="languageGroup" 
							itemClick="languageChangedButtonClick(event);"/>
	</fx:Declarations>
	<fx:Script>
		<![CDATA[
        import mx.events.ItemClickEvent;

        import ru.teachbase.manage.LocaleManager;
        import ru.teachbase.model.App;
        import ru.teachbase.module.settings.events.SettingsEvent;
        import ru.teachbase.utils.Localizer;
        import ru.teachbase.utils.shortcuts.config;
        import ru.teachbase.utils.shortcuts.style;
        import ru.teachbase.utils.shortcuts.translate;

        public static const label:String = 'global_set';

        public static const iconOut:String = 'gearOut';
        public static const iconOver:String = 'gearOver';
        public static const skinName:String = 'globalsettings';

        override public function get label():String {
            return 'global_set';
        }

        private function onAddedToStage():void {
            if (config(SettingsEvent.NOTIFICATION_ENABLED, 1) === 1) {
                notificationCheckBox.selected = true;
            }

            if (int(config(SettingsEvent.CAMERA_REQUEST_ENABLED)) === 1) {
                cameraCheckBox.selected = true;
            }
        }

        private function languageChangedButtonClick(evt:ItemClickEvent):void {
            chagedStatusSend(SettingsEvent.LANGUAGE, evt.item, false);
        }

        protected function cameraRequestEnabled(event:MouseEvent):void {
            chagedStatusSend(SettingsEvent.CAMERA_REQUEST_ENABLED, CheckBox(event.target).selected ? 1 : 0, true);
        }

        protected function privateChatEnabled(event:MouseEvent):void {

        }

        protected function notificationEnabled(event:MouseEvent):void {
            chagedStatusSend(SettingsEvent.NOTIFICATION_ENABLED, CheckBox(event.target).selected ? 1 : 0);
        }


        public function localize():void {

            langLbl && (langLbl.text = translate('lang_choose', 'settings'));
            notifLbl && (notifLbl.text = translate('set_label', 'notifications'));
            notificationCheckBox && (notificationCheckBox.label = translate('set_receive', 'notifications'));
            usersLbl && (usersLbl.text = translate('set_label', 'users'));
            reqLbl && (reqLbl.text = translate('set_requests_off', 'users'));
        }
        ]]>
	</fx:Script>
	<s:VGroup  gap="10" top="14" width="100%">
		<s:Label initialize="langLbl.text=translate('lang_choose','settings')" id="langLbl"  color="0x6892B5" fontSize="13" paddingLeft="22"/>
		<s:Group>
			<components:RadioList dataProvider="{LocaleManager.getLocales()}" itemRenderer="ru.teachbase.module.settings.components.RadioItemRenderer"  
					contentBackgroundAlpha="0"  horizontalScrollPolicy="off" verticalScrollPolicy="off" left="22" height="40" group="{languageGroup}"/>
		</s:Group>	
		<s:Group>
			<s:BitmapImage left="2" right="2" width="{this.width-4}" fillMode="repeat" source="{style('globalsettings','break')}" />
		</s:Group>
		
		<s:Label id="notifLbl" initialize="notifLbl.text=translate('set_label','notifications')" color="0x6892B5" fontSize="13" paddingLeft="22"/>
		<s:VGroup paddingLeft="22">
			<s:CheckBox id="notificationCheckBox"  initialize="notificationCheckBox.label=translate('set_receive','notifications')" skinClass="ru.teachbase.skins.CheckBoxSkin"  click="notificationEnabled(event)"/>
		</s:VGroup>
		<s:Group>
			<s:BitmapImage left="2" right="2" width="{this.width-4}" fillMode="repeat" source="{style('globalsettings','break')}" />
		</s:Group>
		
		<s:Label id="usersLbl" initialize="usersLbl.text=translate('set_label','users')" color="0x6892B5" fontSize="13" paddingLeft="22"
				 includeInLayout="{App.user.isAdmin()}"
				 visible="{App.user.isAdmin()}"/>
		<s:HGroup paddingLeft="22" includeInLayout="{App.user.isAdmin()}"
				  visible="{App.user.isAdmin()}">
			<s:CheckBox id="cameraCheckBox" label="" skinClass="ru.teachbase.skins.CheckBoxSkin" click="cameraRequestEnabled(event)"/>
			<s:Label id="reqLbl" initialize="reqLbl.text=translate('set_requests_off','users')" color="0x515151" fontSize="13" paddingLeft="10"/>
		</s:HGroup>
		<!--s:Group includeInLayout="{Permissions.isAdmin(App.room.user.permissions)}"
				 visible="{Permissions.isAdmin(App.room.user.permissions)}">
			<s:BitmapImage left="2" right="2" width="{this.width-4}" fillMode="repeat" source="{s('globalsettings','break')}" />
		</s:Group-->
		
		<!--s:Label text="Модуль чата" color="0x6892B5" fontSize="13" paddingLeft="22"/>
		<s:VGroup paddingLeft="22">
			<s:CheckBox id="privateChatCheckBox"  label="Активация приватного чата" skinClass="ru.teachbase.skins.CheckBoxSkin" click="privateChatEnabled(event)"/>
		</s:VGroup>
		<s:Group>
			<s:BitmapImage left="2" right="2" width="{this.width-4}" fillMode="repeat" source="{s('globalsettings','break')}" />
		</s:Group-->
	</s:VGroup>
</settings:SettingsElement>
